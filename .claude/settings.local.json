{
  "permissions": {
    "allow": [
      "WebSearch",
      "WebFetch(domain:github.com)",
      "WebFetch(domain:shotstack.com)",
      "WebFetch(domain:docs.crewai.com)",
      "WebFetch(domain:postiz.com)",
      "WebFetch(domain:typebot.io)",
      "WebFetch(domain:n8n.io)",
      "Bash(node:*)",
      "Bash(git clone --depth 1 https://github.com/nextauth/nextauth.git next-auth)",
      "Bash(git clone --depth 1 https://github.com/shadcn-ui/ui.git shadcn-ui)",
      "Bash(git clone --depth 1 https://github.com/microsoft/playwright.git playwright)",
      "Bash(git clone --depth 1 https://github.com/yjs/yjs.git yjs)",
      "Bash(git clone:*)",
      "Bash(find:*)",
      "Bash(pnpm install:*)",
      "Bash(pnpm approve-builds:*)",
      "Bash(pnpm --version:*)",
      "Bash(pnpm config:*)",
      "Bash(ls:*)",
      "Bash(pnpm rebuild:*)",
      "Bash(npx prisma generate:*)",
      "Bash(pnpm exec prisma:*)",
      "Bash(pnpm build:*)",
      "Bash(pnpm test:*)",
      "Bash(pnpm lint:*)",
      "Bash(git init:*)",
      "Bash(git add:*)",
      "Bash(git config:*)",
      "Bash(git commit:*)",
      "WebFetch(domain:www.npmjs.com)",
      "WebFetch(domain:tldraw.dev)",
      "Bash(npm view:*)",
      "Bash(pnpm db:push:*)",
      "Bash(pnpm typecheck:*)",
      "Bash(npx tsc:*)",
      "Bash(pnpm --filter @creator-studio/web build:*)",
      "Bash(pnpm add:*)",
      "Bash(for file in /Users/dobby/Heroin/creatorstudio/packages/ai/src/**/*.{ts,tsx} /Users/dobby/Heroin/creatorstudio/apps/web/app/routes/api.ai.ts /Users/dobby/Heroin/creatorstudio/apps/web/app/routes/dashboard/ai.tsx)",
      "Bash(do [ -f \"$file\" ])",
      "Bash(done)",
      "Bash(for:*)",
      "Bash(wc:*)",
      "Bash(pnpm --filter \"@creator-studio/*\" test:*)",
      "Bash(grep:*)",
      "Bash(git -C /Users/dobby/Heroin/creatorstudio branch:*)",
      "Bash(pnpm --filter \"@creator-studio/db\" test:*)",
      "Bash(pnpm --filter \"@creator-studio/web\" test:*)",
      "Bash(pnpm run build:*)",
      "Bash(pnpm --filter @creator-studio/auth test:*)",
      "Bash(git -C /Users/dobby/Heroin/creatorstudio status --short)",
      "Bash(git -C /Users/dobby/Heroin/creatorstudio log --oneline -10)",
      "Bash(pnpm --filter @creator-studio/web exec tsc:*)",
      "Bash(pnpm --filter @creator-studio/web exec react-router typegen:*)",
      "Bash(pnpm --filter @creator-studio/web exec vite build:*)",
      "Bash(pnpm exec tsc:*)",
      "Bash(git push:*)",
      "Bash(pnpm -F @creator-studio/db exec prisma generate:*)",
      "Bash(SKIP_ENV_VALIDATION=true pnpm exec tsc:*)",
      "Bash(npx react-router typegen:*)",
      "Bash(pnpm turbo build:*)",
      "Bash(npx vitest run:*)",
      "Bash(repomix:*)",
      "Bash(npm run build:*)",
      "Bash(pnpm vitest run:*)",
      "Bash(pnpm --filter @creator-studio/crawler test -- --reporter=verbose src/scrapers/facebook/__tests__/)",
      "Bash(pnpm --filter @creator-studio/crawler test -- src/scrapers/facebook/__tests__/)",
      "Bash(do if [ -d \"$pkg/src\" ])",
      "Bash(then echo \"=== $pkg ===\" find \"$pkg/src\" -type f \\\\\\( -name \"*.ts\" -o -name \"*.tsx\" \\\\\\))",
      "Bash(pnpm exec vitest run:*)",
      "Bash(npm info:*)",
      "Bash(npm run typecheck:*)",
      "Bash(git status:*)",
      "Bash(pnpm run test)",
      "Bash(git rm:*)",
      "Bash(head:*)",
      "Bash(pnpm tsc:*)",
      "Bash(command -v:*)",
      "Bash(pnpm list:*)",
      "Bash(pnpm info:*)",
      "Bash(python3:*)",
      "Bash(pnpm ls:*)",
      "Bash(pnpm run typecheck:*)",
      "Bash(pnpm --filter @creator-studio/ai test:*)",
      "Bash(pnpm --filter @creator-studio/ai add:*)",
      "Bash(pnpm --filter @creator-studio/ai exec vitest run:*)",
      "Bash(docker info:*)",
      "Bash(docker compose:*)",
      "Bash(lsof:*)",
      "Bash(docker ps:*)",
      "Bash(DATABASE_URL=\"postgresql://postgres:postgres@localhost:5433/creator_studio\" DIRECT_DATABASE_URL=\"postgresql://postgres:postgres@localhost:5433/creator_studio\" pnpm exec prisma migrate dev:*)",
      "Bash(PGPASSWORD=postgres psql:*)",
      "Bash(pkill:*)",
      "Bash(curl:*)",
      "Bash(pnpm exec eslint:*)",
      "Bash(git check-ignore:*)",
      "Bash(/Users/dobby/Heroin/creatorstudio/plans/260222-1620-auth-upgrade/SUMMARY.md << 'EOF'\n# Auth Upgrade ‚Äî Quick Reference\n\n## üìä Plan Overview\n\n**Total Effort:** 18 hours\n**Phases:** 5\n**Status:** Ready for implementation\n**Branch:** main\n\n## üéØ Goal\n\nUpgrade Creator Studio auth from basic email/password to production-ready system with:\n- ‚úÖ Email service integration \\(Resend\\)\n- ‚úÖ 2FA with TOTP + backup codes\n- ‚úÖ Account security \\(password change, sessions, deletion\\)\n- ‚úÖ Admin panel + multi-session support\n- ‚úÖ Production environment configuration\n\n## üìã Phase Breakdown\n\n```\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ Phase 1: Email Service \\(P0\\) ‚Äî 4h                        ‚îÇ\n‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ\n‚îÇ ‚Ä¢ Resend integration                                    ‚îÇ\n‚îÇ ‚Ä¢ Email templates \\(verify, reset, magic-link\\)           ‚îÇ\n‚îÇ ‚Ä¢ Wire up Better Auth callbacks                         ‚îÇ\n‚îÇ ‚Ä¢ Forgot password flow                                  ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n                         ‚Üì\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ Phase 2: 2FA UI \\(P1\\) ‚Äî 4h                               ‚îÇ\n‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ\n‚îÇ ‚Ä¢ TOTP QR code setup                                    ‚îÇ\n‚îÇ ‚Ä¢ 6-digit code input                                    ‚îÇ\n‚îÇ ‚Ä¢ 10 backup codes                                       ‚îÇ\n‚îÇ ‚Ä¢ Sign-in challenge page                                ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n                         ‚Üì\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ Phase 3: Account Security \\(P1\\) ‚Äî 4h                     ‚îÇ\n‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ\n‚îÇ ‚Ä¢ Password change with strength meter                   ‚îÇ\n‚îÇ ‚Ä¢ Active sessions list + revoke                         ‚îÇ\n‚îÇ ‚Ä¢ Account deletion \\(soft delete, 30-day grace\\)          ‚îÇ\n‚îÇ ‚Ä¢ GitHub OAuth integration                              ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n                         ‚Üì\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ Phase 4: Admin & Multi-session \\(P2\\) ‚Äî 4h                ‚îÇ\n‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ\n‚îÇ ‚Ä¢ Admin panel \\(ban/unban, impersonate\\)                  ‚îÇ\n‚îÇ ‚Ä¢ User management UI                                    ‚îÇ\n‚îÇ ‚Ä¢ Multi-session device tracking                         ‚îÇ\n‚îÇ ‚Ä¢ Account switcher \\(max 5 accounts\\)                     ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n                         ‚Üì\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ Phase 5: Env Files \\(P0\\) ‚Äî 2h                            ‚îÇ\n‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ\n‚îÇ ‚Ä¢ .env.local \\(Docker PG 5433, Redis 6379\\)               ‚îÇ\n‚îÇ ‚Ä¢ .env.production template                              ‚îÇ\n‚îÇ ‚Ä¢ Setup guides + OAuth docs                             ‚îÇ\n‚îÇ ‚Ä¢ Env validation at startup                             ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n```\n\n## üîë New Dependencies\n\n```json\n{\n  \"packages/auth\": {\n    \"resend\": \"^4.0.0\",\n    \"@react-email/components\": \"^0.0.25\"\n  },\n  \"apps/web\": {\n    \"qrcode.react\": \"^4.1.0\",\n    \"zxcvbn\": \"^4.4.2\"\n  }\n}\n```\n\n## üåç New Environment Variables\n\n```bash\n# Phase 1: Email\nRESEND_API_KEY=\"\"\nRESEND_FROM_EMAIL=\"noreply@creatorstudio.app\"\n\n# Phase 3: GitHub OAuth\nGITHUB_CLIENT_ID=\"\"\nGITHUB_CLIENT_SECRET=\"\"\n\n# Phase 5: Generated Secrets\nBETTER_AUTH_SECRET=\"<openssl rand -hex 32>\"\n```\n\n## üìÅ Key Files to Create\n\n### Phase 1 \\(6 files\\)\n- `packages/auth/src/lib/email-sender.ts`\n- `packages/auth/src/templates/email-layout.tsx`\n- `packages/auth/src/templates/verify-email.tsx`\n- `packages/auth/src/templates/reset-password.tsx`\n- `packages/auth/src/templates/magic-link.tsx`\n- `apps/web/app/routes/forgot-password.tsx`\n\n### Phase 2 \\(5 files\\)\n- `apps/web/app/routes/dashboard/settings/security.tsx`\n- `apps/web/app/routes/sign-in/verify-2fa.tsx`\n- `apps/web/app/components/auth/qr-code-display.tsx`\n- `apps/web/app/components/auth/backup-codes-display.tsx`\n- `apps/web/app/components/auth/totp-input.tsx`\n\n### Phase 3 \\(6 files\\)\n- `apps/web/app/routes/dashboard/settings/password.tsx`\n- `apps/web/app/routes/dashboard/settings/sessions.tsx`\n- `apps/web/app/routes/dashboard/settings/account.tsx`\n- `apps/web/app/components/auth/password-strength-meter.tsx`\n- `apps/web/app/components/auth/session-card.tsx`\n- `packages/db/src/lib/soft-delete-users.ts`\n\n### Phase 4 \\(6 files\\)\n- `apps/web/app/routes/admin/users.tsx`\n- `apps/web/app/routes/admin/users.$userId.tsx`\n- `apps/web/app/components/admin/user-table.tsx`\n- `apps/web/app/components/admin/impersonate-button.tsx`\n- `apps/web/app/components/auth/account-switcher.tsx`\n- `packages/db/src/lib/audit-log.ts`\n\n### Phase 5 \\(5 files\\)\n- `.env.local` \\(NOT committed\\)\n- `.env.production` \\(template, safe to commit\\)\n- `docs/local-setup.md`\n- `docs/oauth-setup.md`\n- `apps/web/app/lib/env-validation.ts`\n\n## üóÑÔ∏è Database Migrations\n\n```prisma\n// Phase 3: Soft Delete\nmodel User {\n  deletedAt DateTime?\n}\n\n// Phase 4: Admin + Multi-session \\(Better Auth migrations\\)\nmodel User {\n  role   String  @default\\(\"user\"\\)  // user | admin\n  banned Boolean @default\\(false\\)\n}\n\nmodel Device {\n  // Multi-session device fingerprinting\n}\n\nmodel AuditLog {\n  // Admin action tracking\n}\n```\n\n## ‚úÖ Success Criteria\n\n- [ ] Email verification works \\(Resend delivery <5s\\)\n- [ ] Password reset flow works end-to-end\n- [ ] 2FA QR code scannable by Google Authenticator\n- [ ] Backup codes downloadable + single-use\n- [ ] Password change invalidates other sessions\n- [ ] Session revocation immediate\n- [ ] Account deletion soft deletes with 30-day grace\n- [ ] GitHub OAuth sign-in/sign-up works\n- [ ] Admin can ban/unban users\n- [ ] Multi-session switcher works \\(max 5 accounts\\)\n- [ ] .env.local works with Docker \\(PG 5433, Redis 6379\\)\n- [ ] All 59 existing auth tests still pass\n\n## üö® Critical Constraints\n\n- ‚úÖ Keep better-auth at ^1.4.18 \\(NOT 1.5.0 beta\\)\n- ‚úÖ No SSO/SAML/Stripe/SCIM/passkey \\(YAGNI\\)\n- ‚úÖ Prisma migrations additive only \\(no destructive changes\\)\n- ‚úÖ Files under 200 lines \\(modularize if needed\\)\n\n## üîê Security Highlights\n\n| Feature | Protection |\n|---------|------------|\n| Email tokens | Hashed in DB, 15-24h expiry |\n| Rate limiting | 5 emails/user/hour, 5 2FA attempts = 15min lockout |\n| 2FA secrets | Encrypted at rest, backup codes bcrypt hashed |\n| Password change | Requires current password verification |\n| Session revoke | Immediate \\(no grace period\\) |\n| Account deletion | Soft delete, 30-day grace, reactivation on sign-in |\n| Admin actions | Audit logged \\(immutable\\) |\n| Env secrets | .env.local never committed, openssl CSPRNG |\n\n## üìö Documentation\n\n- [Full Plan]\\(./plan.md\\)\n- [Phase 1: Email Service]\\(./phase-01-email-service-verification.md\\)\n- [Phase 2: 2FA UI]\\(./phase-02-2fa-ui-completion.md\\)\n- [Phase 3: Account Security]\\(./phase-03-account-security.md\\)\n- [Phase 4: Admin & Multi-session]\\(./phase-04-admin-multi-session.md\\)\n- [Phase 5: Env Files]\\(./phase-05-env-files.md\\)\n- [Research: Reference Analysis]\\(./research/researcher-01-reference-analysis.md\\)\n- [Research: Current Auth Analysis]\\(./research/researcher-02-current-auth-analysis.md\\)\n\n## üöÄ Quick Start\n\n```bash\n# 1. Read the plan\ncat plans/260222-1620-auth-upgrade/plan.md\n\n# 2. Start with Phase 1\ncat plans/260222-1620-auth-upgrade/phase-01-email-service-verification.md\n\n# 3. Implement ‚Üí Test ‚Üí Review \\(repeat for each phase\\)\n```\n\n---\n\n**Plan Directory:** `/Users/dobby/Heroin/creatorstudio/plans/260222-1620-auth-upgrade/`\n**Created:** 2026-02-22\n**Ready for:** Implementation handoff\nEOF)",
      "Bash(chmod:*)",
      "WebFetch(domain:better-auth.com)",
      "Bash(pnpm remove:*)",
      "Bash(git reset:*)"
    ]
  }
}
